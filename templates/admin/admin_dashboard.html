{% extends "layout.html" %}
{% block content %}
<div class="dashboard-container">
    <div class="header-actions">
        <a href="{{ url_for('admin.summary_page') }}" class="btn btn-outline btn-sm">Summary</a>
        <a href="{{ url_for('admin.all_records') }}" class="btn btn-outline btn-sm">All Records</a>
        <a href="{{ url_for('admin.view_users') }}" class="btn btn-outline btn-sm">All Users</a>
        <a href="{{ url_for('admin.add_lot_page') }}" class="btn btn-red btn-sm">Create New Lot</a>
        <a href="{{ url_for('auth.logout') }}" class="btn btn-outline btn-sm">Logout</a>
    </div>
    <hr>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="flash-{{ category }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
{% endwith %}
<div class="search-container">
    <form action="{{ url_for('admin.search') }}" method="GET" class="search-form">
        <input type="search" name="q" placeholder="Search for lots, users, addresses..." class="search-input" required>
        <button type="submit" class="btn btn-red btn-sm">Search</button>
    </form>
</div>
    <hr>

    <h2>Existing Parking Lots</h2>

    {% if lots %}
        <div class="lot-list">
            {% for lot in lots %}
                <div class="lot-card">
                    <h3>{{ lot.name }}</h3>
                    <p class="lot-meta">{{ lot.address }}, {{ lot.pincode }}</p>
                    <div class="lot-details">
                        <span>Capacity: {{ lot.capacity }} spots</span>
                        <span>Price: â‚¹{{ "%.2f"|format(lot.price_per_hour) }}/hr</span>
                    </div>
                    <a href="{{ url_for('admin.lot_details', lot_id=lot.id) }}" class="details-link">View Details &raquo;</a>

                     <div class="lot-actions">
                     <a href="{{ url_for('admin.edit_lot', lot_id=lot.id) }}" class="btn-action btn-edit">Edit</a>
                     <form method="POST" action="{{ url_for('admin.delete_lot', lot_id=lot.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this lot?');">
                     <button type="submit" class="btn-action btn-delete">Delete</button>
        </form>
    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="card-placeholder">
            <p>No parking lots have been created yet. Get started by creating one!</p>
        </div>
    {% endif %}

</div>
{% endblock %}